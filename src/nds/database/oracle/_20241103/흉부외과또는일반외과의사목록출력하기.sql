-- 흉부외과 또는 일반외과 의사 목록 출력하기

-- CREATE TABLE

CREATE TABLE DOCTOR (
	DR_NAME	VARCHAR(20)	NOT NULL,
	DR_ID	VARCHAR(10)	NOT NULL,
	LCNS_NO	VARCHAR(30)	NOT NULL,
	HIRE_YMD DATE NOT NULL,
	MCDP_CD	VARCHAR(6),
	TLNO VARCHAR(50),
	CONSTRAINT DOCTOR_PK1 PRIMARY KEY (DR_ID)
);

-- INSERT DATA

INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('루피','DR20090029','LC00010001', '2009-03-01','CS','01085482011');
INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('패티','DR20090001','LC00010901','2009-07-01','CS','01085220122');
INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('뽀로로','DR20170123','LC00091201','2017-03-01','GS','01034969210');
INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('티거','DR20100011','LC00011201','2010-03-01','NP','01034229818');
INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('품바','DR20090231','LC00011302','2015-11-01','OS','01049840278');
INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('티몬','DR20090112','LC00011162','2010-03-01','FM','01094622190');
INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('니모','DR20200012','LC00911162','2020-03-01','CS','01089483921');
INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('오로라','DR20100031','LC00010327','2010-11-01','OS','01098428957');
INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('자스민','DR20100032','LC00010192','2010-03-01','GS','01023981922');
INSERT INTO DOCTOR (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO)
VALUES ('벨','DR20100039','LC00010562','2010-07-01','GS','01058390758');

-- SELECT 문제
/*
 * DOCTOR 테이블에서 진료과가 흉부외과(CS)이거나 일반외과(GS)인 의사의 
 * 이름, 의사ID, 진료과, 고용일자를 조회하는 SQL문을 작성해주세요. 
 * 이때 결과는 고용일자를 기준으로 내림차순 정렬하고, 고용일자가 같다면 
 * 이름을 기준으로 오름차순 정렬해주세요.
 * */

SELECT DR_NAME, DR_ID, MCDP_CD, TO_CHAR(HIRE_YMD,'YYYY-MM-DD')
FROM DOCTOR
WHERE MCDP_CD IN ('CS','GS')
ORDER BY HIRE_YMD DESC, DR_NAME ASC;